<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./static/styleForm.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <title>Registration Form</title>
  </head>
  <body>
    <section class="vh-100 gradient-custom">
      <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
          <div class="col-12 col-md-8 col-lg-6 col-xl-5">
            <div class="card bg-dark text-white" style="border-radius: 1rem">
              <div class="card-body p-5 text-center">
                <div class="mt-md-4">
                  <form
                    id="registrationForm"
                    action="http://localhost:4000/register"
                    method="post"
                    enctype="multipart/form-data"
                  >
                    <h1 class="fw-bold mb-2 text-uppercase text-success">
                      Registration
                    </h1>
                    <p class="text-white-50 mb-3">
                      Create a new account to play the game!
                    </p>
                    {% if error == "True" %}
                    <div class="form-outline form-white mb-4">
                      <p class="text-danger">
                        Error, username already registered
                      </p>
                    </div>
                    {% endif %}

                    <div class="form-outline form-white mb-4">
                      <input
                        type="text"
                        id="username"
                        name="username"
                        class="form-control form-control-lg"
                        required
                      />
                      <label class="form-label" for="username">Username</label>
                    </div>

                    <div class="form-outline form-white mb-4">
                      <input
                        type="password"
                        id="password"
                        name="password"
                        class="form-control form-control-lg"
                        required
                      />
                      <label class="form-label" for="password">Password</label>
                    </div>

                    <div class="form-outline form-white mb-4">
                      <input
                        type="password"
                        id="confirm_password"
                        name="confirm_password"
                        class="form-control form-control-lg"
                        required
                      />
                      <label class="form-label" for="confirm_password"
                        >Confirm Password</label
                      >
                      <br />
                      <p
                        id="passwordMismatch"
                        style="color: red; display: none"
                      >
                        Passwords do not match.
                      </p>
                    </div>

                    <div class="container">
                      <div class="row justify-content-center">
                        <label class="form-label font-weight-bold"
                          >Choose your own avatar!</label
                        >
                        <table class="table">
                          <tbody>
                            <tr>
                              <td>
                                <button type="button" onclick="setAvatarId()">
                                  <img
                                    src="../static/assets/playerIcons/1.png"
                                    class="img-thumbnail"
                                    alt="..."
                                    id="avatar-1"
                                  />
                                </button>
                              </td>
                              <td>
                                <button
                                  id="button-2"
                                  type="button"
                                  onclick="setAvatarId()"
                                >
                                  <img
                                    src="../static/assets/playerIcons/2.png"
                                    class="img-thumbnail"
                                    alt="..."
                                    id="avatar-2"
                                  />
                                </button>
                              </td>
                              <td>
                                <button
                                  id="button-3"
                                  type="button"
                                  onclick="setAvatarId()"
                                >
                                  <img
                                    src="../static/assets/playerIcons/3.png"
                                    class="img-thumbnail"
                                    alt="..."
                                    id="avatar-3"
                                  />
                                </button>
                              </td>
                              <td>
                                <button
                                  id="button-4"
                                  type="button"
                                  onclick="setAvatarId()"
                                >
                                  <img
                                    src="../static/assets/playerIcons/4.png"
                                    class="img-thumbnail"
                                    alt="..."
                                    id="avatar-4"
                                  />
                                </button>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <button
                                  id="button-5"
                                  type="button"
                                  onclick="setAvatarId()"
                                >
                                  <img
                                    src="../static/assets/playerIcons/5.png"
                                    class="img-thumbnail"
                                    alt="..."
                                    id="avatar-5"
                                  />
                                </button>
                              </td>
                              <td>
                                <button
                                  id="button-6"
                                  type="button"
                                  onclick="setAvatarId()"
                                >
                                  <img
                                    src="../static/assets/playerIcons/6.png"
                                    class="img-thumbnail"
                                    alt="..."
                                    id="avatar-6"
                                  />
                                </button>
                              </td>
                              <td>
                                <button
                                  id="button-7"
                                  type="button"
                                  onclick="setAvatarId()"
                                >
                                  <img
                                    src="../static/assets/playerIcons/7.png"
                                    class="img-thumbnail"
                                    alt="..."
                                    id="avatar-7"
                                  />
                                </button>
                              </td>
                              <td>
                                <button
                                  id="button-8"
                                  type="button"
                                  onclick="setAvatarId()"
                                >
                                  <img
                                    src="../static/assets/playerIcons/8.png"
                                    class="img-thumbnail"
                                    alt="..."
                                    id="avatar-8"
                                  />
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>

                    <button
                      class="btn btn-outline-success btn-lg px-5 mt-3"
                      type="submit"
                      value="Register"
                    >
                      Register
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!--
    <h1>Registration Form</h1>

    <form
      id="registrationForm"
      action="http://localhost:4000/register"
      method="post"
      enctype="multipart/form-data"
    >
      <label for="username">Username:</label>
      <input type="text" id="username" name="username" required /><br /><br />

      <label for="password">Password:</label>
      <input
        type="password"
        id="password"
        name="password"
        required
      /><br /><br />

      <label for="confirm_password">Confirm Password:</label>
      <input
        type="password"
        id="confirm_password"
        name="confirm_password"
        required
      /><br />
      <p id="passwordMismatch" style="color: red; display: none">
        Passwords do not match.
      </p>
      <br />

      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <table class="table">
              <tbody>
                <tr>
                  <td>
                    <button type="button" onclick="setAvatarId()">
                      <img
                        src="../static/assets/playerIcons/1.png"
                        class="img-thumbnail"
                        alt="..."
                        id="avatar-1"
                      />
                    </button>
                  </td>
                  <td>
                    <button id="button-2" type="button" onclick="setAvatarId()">
                      <img
                        src="../static/assets/playerIcons/2.png"
                        class="img-thumbnail"
                        alt="..."
                        id="avatar-2"
                      />
                    </button>
                  </td>
                  <td>
                    <button id="button-3" type="button" onclick="setAvatarId()">
                      <img
                        src="../static/assets/playerIcons/3.png"
                        class="img-thumbnail"
                        alt="..."
                        id="avatar-3"
                      />
                    </button>
                  </td>
                  <td>
                    <button id="button-4" type="button" onclick="setAvatarId()">
                      <img
                        src="../static/assets/playerIcons/4.png"
                        class="img-thumbnail"
                        alt="..."
                        id="avatar-4"
                      />
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <button id="button-5" type="button" onclick="setAvatarId()">
                      <img
                        src="../static/assets/playerIcons/5.png"
                        class="img-thumbnail"
                        alt="..."
                        id="avatar-5"
                      />
                    </button>
                  </td>
                  <td>
                    <button id="button-6" type="button" onclick="setAvatarId()">
                      <img
                        src="../static/assets/playerIcons/6.png"
                        class="img-thumbnail"
                        alt="..."
                        id="avatar-6"
                      />
                    </button>
                  </td>
                  <td>
                    <button id="button-7" type="button" onclick="setAvatarId()">
                      <img
                        src="../static/assets/playerIcons/7.png"
                        class="img-thumbnail"
                        alt="..."
                        id="avatar-7"
                      />
                    </button>
                  </td>
                  <td>
                    <button id="button-8" type="button" onclick="setAvatarId()">
                      <img
                        src="../static/assets/playerIcons/8.png"
                        class="img-thumbnail"
                        alt="..."
                        id="avatar-8"
                      />
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <input type="submit" value="Register" />
    </form>
    -->
    <script type="text/javascript">
      var avatarId = 1;
      document.addEventListener("DOMContentLoaded", function () {
        var registrationForm = document.getElementById("registrationForm");
        var passwordInput = document.getElementById("password");
        var confirmPasswordInput = document.getElementById("confirm_password");
        var avatarInput = document.getElementById("avatar");

        registrationForm.addEventListener("submit", function (event) {
          var username = document.getElementById("username").value;
          var password = passwordInput.value;
          var confirmPassword = confirmPasswordInput.value;

          if (password !== confirmPassword) {
            document.getElementById("passwordMismatch").style.display = "block";
            console.log("Password missmatch");
            return false;
          }

          var hiddenInput = document.createElement("input");
          hiddenInput.type = "hidden";
          hiddenInput.name = "avatarId";
          hiddenInput.id = "avatarId";
          hiddenInput.value = avatarId;
          registrationForm.appendChild(hiddenInput);
          registrationForm.submit();
        });
      });

      function setAvatarId() {
        event.preventDefault;
        const numericAvatarId = parseInt(event.target.id.match(/\d+/)[0], 10);
        avatarId = numericAvatarId;
      }
    </script>
  </body>
</html>
